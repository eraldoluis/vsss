<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>The PG Library: libpg::NeuralNetBatch Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="namespacelibpg.html">libpg</a>::<a class="el" href="classlibpg_1_1_neural_net_batch.html">NeuralNetBatch</a></div>
<h1>libpg::NeuralNetBatch Class Reference</h1><!-- doxytag: class="libpg::NeuralNetBatch" --><!-- doxytag: inherits="libpg::NeuralNet" --><code>#include &lt;<a class="el" href="_neural_net_batch_8hh-source.html">NeuralNetBatch.hh</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for libpg::NeuralNetBatch:</div>
<div class="dynsection">

<p><center><img src="classlibpg_1_1_neural_net_batch.png" usemap="#libpg::NeuralNetBatch_map" border="0" alt=""></center>
<map name="libpg::NeuralNetBatch_map">
<area href="classlibpg_1_1_neural_net.html" alt="libpg::NeuralNet" shape="rect" coords="0,56,134,80">
<area href="classlibpg_1_1_approximator.html" alt="libpg::Approximator" shape="rect" coords="0,0,134,24">
</map>
</div>

<p>
<a href="classlibpg_1_1_neural_net_batch-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#5f1108002516b39f446a012554096f7b">NeuralNetBatch</a> (<a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;<a class="el" href="classlibpg_1_1_neural_net.html#03f8b8d95ac6767dcccf9eff3d6e6052">dims</a>, <a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;<a class="el" href="classlibpg_1_1_neural_net.html#4111c1f220cd1e954b9028f82878ec23">squash</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#1b5560be6830ef40196bcf240d18e983">NeuralNetBatch</a> (int in, int out)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#cf3d9679da9124f5b8be00db44344905">batchStep</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#ddc3ad267964158742957f996ae93830">computeDirection</a> (int steps)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#cf069a1a0eeeaedc3efb3eb491c42a5e">accumulateGrad</a> (double reward, <a class="el" href="classlibpg_1_1_observation.html">Observation</a> &amp;newObs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#ff1d545a61e0716fdaf337c2305a383c">resetGrad</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#3e208815d0c7a2f5bb467f02b7ae1799">reduce</a> (<a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;v, <a class="el" href="classlibpg_1_1_approximator.html#c1375d461c4e531da046f2fad93287df">StatsEnum</a> s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#2ecfcc175f754897ccbc2c4b81e6a92e">scatter</a> (<a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;v, <a class="el" href="classlibpg_1_1_approximator.html#c1375d461c4e531da046f2fad93287df">StatsEnum</a> s)</td></tr>

<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacelibpg.html#4d1c6393e8ddc5dab3bb3733d5b5cdd8">Matrix</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibpg_1_1_neural_net_batch.html#70b9ec8ec2bfac19c00e76a8f5175659">grads</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A version of neural network that supports aggregated gradients 
<p>Definition at line <a class="el" href="_neural_net_batch_8hh-source.html#l00013">13</a> of file <a class="el" href="_neural_net_batch_8hh-source.html">NeuralNetBatch.hh</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="5f1108002516b39f446a012554096f7b"></a><!-- doxytag: member="libpg::NeuralNetBatch::NeuralNetBatch" ref="5f1108002516b39f446a012554096f7b" args="(Vector &amp;dims, Vector &amp;squash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libpg::NeuralNetBatch::NeuralNetBatch           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>squash</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Same as neural network call, but additionaly resizes accumulated gradient matrices 
<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00035">35</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, and <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>.</p>

</div>
</div><p>
<a class="anchor" name="1b5560be6830ef40196bcf240d18e983"></a><!-- doxytag: member="libpg::NeuralNetBatch::NeuralNetBatch" ref="1b5560be6830ef40196bcf240d18e983" args="(int in, int out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libpg::NeuralNetBatch::NeuralNetBatch           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A version of neural network that supports aggregated gradients Create a new linear approximator with given inputs and outputs <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ins</em>&nbsp;</td><td>input dimensionality </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outs</em>&nbsp;</td><td>output dimensionality </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00020">20</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_8hh-source.html#l00014">libpg::NeuralNet::dims</a>, <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, and <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="cf3d9679da9124f5b8be00db44344905"></a><!-- doxytag: member="libpg::NeuralNetBatch::batchStep" ref="cf3d9679da9124f5b8be00db44344905" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::batchStep           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Additional methods that are only for batch gradient algs Assuming we have accumulated a gradient somewhere, step in that direction. 
<p>Reimplemented from <a class="el" href="classlibpg_1_1_approximator.html#87785f7a3ecdbfc4678ac0f35aa2c0ac">libpg::Approximator</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00046">46</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, <a class="el" href="_neural_net_8hh-source.html#l00016">libpg::NeuralNet::layerParams</a>, <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>, and <a class="el" href="_neural_net_8hh-source.html#l00022">libpg::NeuralNet::stepSize</a>.</p>

</div>
</div><p>
<a class="anchor" name="ddc3ad267964158742957f996ae93830"></a><!-- doxytag: member="libpg::NeuralNetBatch::computeDirection" ref="ddc3ad267964158742957f996ae93830" args="(int steps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::computeDirection           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the search direction for the parameters from the current gradient and possible past information. For GPOMDP and most codes this is empty. This could hold conjugation code Or it can extract natural actor critic search direction 
<p>Reimplemented from <a class="el" href="classlibpg_1_1_approximator.html#f8889f18e4ee3b18b8c72a371867a73e">libpg::Approximator</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00055">55</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, and <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>.</p>

</div>
</div><p>
<a class="anchor" name="cf069a1a0eeeaedc3efb3eb491c42a5e"></a><!-- doxytag: member="libpg::NeuralNetBatch::accumulateGrad" ref="cf069a1a0eeeaedc3efb3eb491c42a5e" args="(double reward, Observation &amp;newObs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::accumulateGrad           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibpg_1_1_observation.html">Observation</a> &amp;&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate and accumulate instant gradient into a batch gradient estimate 
<p>Reimplemented from <a class="el" href="classlibpg_1_1_approximator.html#c80c2d2dbc516ed27c4442b4e7695b34">libpg::Approximator</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00063">63</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>, and <a class="el" href="_neural_net_8hh-source.html#l00017">libpg::NeuralNet::layerTraces</a>.</p>

</div>
</div><p>
<a class="anchor" name="ff1d545a61e0716fdaf337c2305a383c"></a><!-- doxytag: member="libpg::NeuralNetBatch::resetGrad" ref="ff1d545a61e0716fdaf337c2305a383c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::resetGrad           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reset the accumulated gradient only. 
<p>Reimplemented from <a class="el" href="classlibpg_1_1_approximator.html#4905cfc8a9bb75f60e4c941072030c5f">libpg::Approximator</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00070">70</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, and <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>.</p>

</div>
</div><p>
<a class="anchor" name="3e208815d0c7a2f5bb467f02b7ae1799"></a><!-- doxytag: member="libpg::NeuralNetBatch::reduce" ref="3e208815d0c7a2f5bb467f02b7ae1799" args="(Vector &amp;v, StatsEnum s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::reduce           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibpg_1_1_approximator.html#c1375d461c4e531da046f2fad93287df">StatsEnum</a>&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>whether to collect params or grads or traces. Only grads done in this routine. Others passed to <a class="el" href="classlibpg_1_1_neural_net.html">NeuralNet</a> </td></tr>
  </table>
</dl>

<p>Reimplemented from <a class="el" href="classlibpg_1_1_neural_net.html#d93bda7242ffa41ade164a53d4f80c04">libpg::NeuralNet</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00080">80</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_u_blas_extras_8cc-source.html#l00132">libpg::UBlasExtras::addMatrixToVector()</a>, <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, <a class="el" href="_approximator_8hh-source.html#l00031">libpg::Approximator::GRADS</a>, <a class="el" href="_neural_net_8hh-source.html#l00016">libpg::NeuralNet::layerParams</a>, <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>, <a class="el" href="_neural_net_8hh-source.html#l00011">libpg::NeuralNet::parameters</a>, and <a class="el" href="_neural_net_8cc-source.html#l00404">libpg::NeuralNet::reduce()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2ecfcc175f754897ccbc2c4b81e6a92e"></a><!-- doxytag: member="libpg::NeuralNetBatch::scatter" ref="2ecfcc175f754897ccbc2c4b81e6a92e" args="(Vector &amp;v, StatsEnum s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libpg::NeuralNetBatch::scatter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibpg.html#62a7899983d918844e93181266713e82">Vector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibpg_1_1_approximator.html#c1375d461c4e531da046f2fad93287df">StatsEnum</a>&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>what to set, can't do GRADS here. </td></tr>
  </table>
</dl>

<p>Reimplemented from <a class="el" href="classlibpg_1_1_neural_net.html#31a7a3bb072ee6533f9f9145beb0830e">libpg::NeuralNet</a>.</p>

<p>Definition at line <a class="el" href="_neural_net_batch_8cc-source.html#l00100">100</a> of file <a class="el" href="_neural_net_batch_8cc-source.html">NeuralNetBatch.cc</a>.</p>

<p>References <a class="el" href="_u_blas_extras_8cc-source.html#l00152">libpg::UBlasExtras::addScaledVectorToMatrix()</a>, <a class="el" href="_neural_net_batch_8hh-source.html#l00017">grads</a>, <a class="el" href="_approximator_8hh-source.html#l00031">libpg::Approximator::GRADS</a>, <a class="el" href="_neural_net_8hh-source.html#l00016">libpg::NeuralNet::layerParams</a>, <a class="el" href="_neural_net_8hh-source.html#l00010">libpg::NeuralNet::layers</a>, <a class="el" href="_neural_net_8hh-source.html#l00011">libpg::NeuralNet::parameters</a>, and <a class="el" href="_neural_net_8cc-source.html#l00430">libpg::NeuralNet::scatter()</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="70b9ec8ec2bfac19c00e76a8f5175659"></a><!-- doxytag: member="libpg::NeuralNetBatch::grads" ref="70b9ec8ec2bfac19c00e76a8f5175659" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibpg.html#4d1c6393e8ddc5dab3bb3733d5b5cdd8">Matrix</a>* <a class="el" href="classlibpg_1_1_neural_net_batch.html#70b9ec8ec2bfac19c00e76a8f5175659">libpg::NeuralNetBatch::grads</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_neural_net_batch_8hh-source.html#l00017">17</a> of file <a class="el" href="_neural_net_batch_8hh-source.html">NeuralNetBatch.hh</a>.</p>

<p>Referenced by <a class="el" href="_neural_net_batch_8cc-source.html#l00063">accumulateGrad()</a>, <a class="el" href="_neural_net_batch_8cc-source.html#l00046">batchStep()</a>, <a class="el" href="_neural_net_batch_8cc-source.html#l00055">computeDirection()</a>, <a class="el" href="_neural_net_batch_8cc-source.html#l00020">NeuralNetBatch()</a>, <a class="el" href="_neural_net_batch_8cc-source.html#l00080">reduce()</a>, <a class="el" href="_neural_net_batch_8cc-source.html#l00070">resetGrad()</a>, and <a class="el" href="_neural_net_batch_8cc-source.html#l00100">scatter()</a>.</p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 10 19:32:12 2007 for The PG Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
